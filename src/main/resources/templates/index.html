<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>WebRTC P2P ë°ëª¨</title>
    <script
            type="text/javascript"
            src="https://cdn.jsdelivr.net/npm/sockjs-client/dist/sockjs.min.js"
    ></script>
    <script
            type="text/javascript"
            src="https://cdn.jsdelivr.net/npm/stompjs/lib/stomp.min.js"
    ></script>
</head>
<body>
<div style="width: 600px; margin: auto; text-align: center; padding-top: 50px;">
    <h2>ğŸ§‘ WebRTC P2P í…ŒìŠ¤íŠ¸</h2>
    <input type="text" id="username" placeholder="ë‹‰ë„¤ì„" />
    <button onclick="connect()">ì—°ê²°</button>

    <div id="log" style="margin-top: 20px;"></div>
</div>

<script>
    let stompClient = null;

    function connect() {
        const socket = new SockJS("http://localhost:16100/ws");
        stompClient = Stomp.over(socket);

        stompClient.connect({}, function () {
            log("âœ… ì—°ê²°ë¨");

            stompClient.subscribe('/topic/message', function (message) {
                log("ğŸ“¥ ìˆ˜ì‹ : " + message.body);
            });

            // í…ŒìŠ¤íŠ¸ìš© ë©”ì‹œì§€
            stompClient.send("/app/message", {}, JSON.stringify({
                type: "offer",
                sender: "userA",
                roomId: "room1",
                target: "userB",
                data: {
                    sdp: "í…ŒìŠ¤íŠ¸ SDP ë©”ì‹œì§€ì…ë‹ˆë‹¤"
                }
            }));
        });
    }

    function log(msg) {
        const logDiv = document.getElementById("log");
        logDiv.innerHTML += `<div>${msg}</div>`;
    }
</script>
</body>
</html>